{"ast":null,"code":"import React,{createContext,useContext,useReducer,useEffect}from'react';import{cartAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();const cartReducer=(state,action)=>{switch(action.type){case'SET_CART':return{...state,items:action.payload,loading:false};case'ADD_ITEM':return{...state,items:[...state.items,action.payload]};case'UPDATE_ITEM':return{...state,items:state.items.map(item=>item.id===action.payload.id?action.payload:item)};case'REMOVE_ITEM':return{...state,items:state.items.filter(item=>item.id!==action.payload)};case'SET_LOADING':return{...state,loading:action.payload};default:return state;}};export const CartProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(cartReducer,{items:[],loading:true});const fetchCart=async()=>{try{dispatch({type:'SET_LOADING',payload:true});// Load from localStorage for development\nconst savedCart=localStorage.getItem('cart');const cartItems=savedCart?JSON.parse(savedCart):[];dispatch({type:'SET_CART',payload:cartItems});}catch(error){console.error('Error fetching cart:',error);dispatch({type:'SET_LOADING',payload:false});}};const addToCart=async item=>{try{// For development, use local storage instead of API\nconst cartItem={id:Date.now(),product:item.product,product_name:item.product_name||'Product',product_image:item.product_image,quantity:item.quantity,package_size:item.package_size,unit_type:item.unit_type,price:item.price,total_price:item.price*item.quantity};dispatch({type:'ADD_ITEM',payload:cartItem});// Save to localStorage\nconst updatedItems=[...state.items,cartItem];localStorage.setItem('cart',JSON.stringify(updatedItems));}catch(error){console.error('Error adding to cart:',error);}};const updateCartItem=async(id,data)=>{try{const updatedItem={...state.items.find(item=>item.id===id),...data};updatedItem.total_price=updatedItem.price*updatedItem.quantity;dispatch({type:'UPDATE_ITEM',payload:updatedItem});const updatedItems=state.items.map(item=>item.id===id?updatedItem:item);localStorage.setItem('cart',JSON.stringify(updatedItems));}catch(error){console.error('Error updating cart item:',error);}};const removeFromCart=async id=>{try{dispatch({type:'REMOVE_ITEM',payload:id});const updatedItems=state.items.filter(item=>item.id!==id);localStorage.setItem('cart',JSON.stringify(updatedItems));}catch(error){console.error('Error removing from cart:',error);}};const getTotalPrice=()=>{return state.items.reduce((total,item)=>total+item.total_price,0);};const getTotalItems=()=>{return state.items.reduce((total,item)=>total+item.quantity,0);};useEffect(()=>{fetchCart();},[]);return/*#__PURE__*/_jsx(CartContext.Provider,{value:{...state,addToCart,updateCartItem,removeFromCart,getTotalPrice,getTotalItems,fetchCart},children:children});};export const useCart=()=>{const context=useContext(CartContext);if(!context){throw new Error('useCart must be used within CartProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","cartAPI","jsx","_jsx","CartContext","cartReducer","state","action","type","items","payload","loading","map","item","id","filter","CartProvider","_ref","children","dispatch","fetchCart","savedCart","localStorage","getItem","cartItems","JSON","parse","error","console","addToCart","cartItem","Date","now","product","product_name","product_image","quantity","package_size","unit_type","price","total_price","updatedItems","setItem","stringify","updateCartItem","data","updatedItem","find","removeFromCart","getTotalPrice","reduce","total","getTotalItems","Provider","value","useCart","context","Error"],"sources":["/Users/poojamr/Documents/Bajrangminioilmill/frontend/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { cartAPI } from '../services/api';\n\nconst CartContext = createContext();\n\nconst cartReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_CART':\n      return { ...state, items: action.payload, loading: false };\n    case 'ADD_ITEM':\n      return { ...state, items: [...state.items, action.payload] };\n    case 'UPDATE_ITEM':\n      return {\n        ...state,\n        items: state.items.map(item =>\n          item.id === action.payload.id ? action.payload : item\n        )\n      };\n    case 'REMOVE_ITEM':\n      return {\n        ...state,\n        items: state.items.filter(item => item.id !== action.payload)\n      };\n    case 'SET_LOADING':\n      return { ...state, loading: action.payload };\n    default:\n      return state;\n  }\n};\n\nexport const CartProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(cartReducer, {\n    items: [],\n    loading: true\n  });\n\n  const fetchCart = async () => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      // Load from localStorage for development\n      const savedCart = localStorage.getItem('cart');\n      const cartItems = savedCart ? JSON.parse(savedCart) : [];\n      dispatch({ type: 'SET_CART', payload: cartItems });\n    } catch (error) {\n      console.error('Error fetching cart:', error);\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  };\n\n  const addToCart = async (item) => {\n    try {\n      // For development, use local storage instead of API\n      const cartItem = {\n        id: Date.now(),\n        product: item.product,\n        product_name: item.product_name || 'Product',\n        product_image: item.product_image,\n        quantity: item.quantity,\n        package_size: item.package_size,\n        unit_type: item.unit_type,\n        price: item.price,\n        total_price: item.price * item.quantity\n      };\n      dispatch({ type: 'ADD_ITEM', payload: cartItem });\n      \n      // Save to localStorage\n      const updatedItems = [...state.items, cartItem];\n      localStorage.setItem('cart', JSON.stringify(updatedItems));\n    } catch (error) {\n      console.error('Error adding to cart:', error);\n    }\n  };\n\n  const updateCartItem = async (id, data) => {\n    try {\n      const updatedItem = { ...state.items.find(item => item.id === id), ...data };\n      updatedItem.total_price = updatedItem.price * updatedItem.quantity;\n      dispatch({ type: 'UPDATE_ITEM', payload: updatedItem });\n      \n      const updatedItems = state.items.map(item => \n        item.id === id ? updatedItem : item\n      );\n      localStorage.setItem('cart', JSON.stringify(updatedItems));\n    } catch (error) {\n      console.error('Error updating cart item:', error);\n    }\n  };\n\n  const removeFromCart = async (id) => {\n    try {\n      dispatch({ type: 'REMOVE_ITEM', payload: id });\n      const updatedItems = state.items.filter(item => item.id !== id);\n      localStorage.setItem('cart', JSON.stringify(updatedItems));\n    } catch (error) {\n      console.error('Error removing from cart:', error);\n    }\n  };\n\n  const getTotalPrice = () => {\n    return state.items.reduce((total, item) => total + item.total_price, 0);\n  };\n\n  const getTotalItems = () => {\n    return state.items.reduce((total, item) => total + item.quantity, 0);\n  };\n\n  useEffect(() => {\n    fetchCart();\n  }, []);\n\n  return (\n    <CartContext.Provider value={{\n      ...state,\n      addToCart,\n      updateCartItem,\n      removeFromCart,\n      getTotalPrice,\n      getTotalItems,\n      fetchCart\n    }}>\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => {\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within CartProvider');\n  }\n  return context;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}